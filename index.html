<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hell Kitty: Nightmare Infinite</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --hk-pink: #ff007f;
            --hk-soft: #ff99cc;
            --hk-dark: #0d0208;
            --hk-void: #000000;
        }

        * { box-sizing: border-box; image-rendering: pixelated; }

        body {
            background-color: var(--hk-void);
            color: #eee;
            font-family: 'Press Start 2P', cursive;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        #game-container {
            position: relative;
            width: 1000px;
            height: 600px;
            border: 4px solid var(--hk-pink);
            overflow: hidden;
            box-shadow: 0 0 50px rgba(255, 0, 127, 0.4);
        }

        #ui-layer {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            pointer-events: none;
            width: calc(100% - 40px);
        }

        .stat-box {
            background: rgba(13, 2, 8, 0.8);
            border-left: 5px solid var(--hk-pink);
            padding: 10px;
            margin-bottom: 10px;
            display: inline-block;
        }

        .bar { width: 200px; height: 10px; background: #222; margin-top: 5px; border: 1px solid #444; }
        .bar-fill { height: 100%; transition: width 0.3s; }

        #level-display {
            position: absolute;
            right: 0;
            top: 0;
            text-align: right;
            color: var(--hk-pink);
            text-shadow: 2px 2px #000;
        }

        /* Scanline Overlay */
        #game-container::after {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px;
            z-index: 5;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="ui-layer">
            <div class="stat-box">
                <div style="font-size: 8px;">VITALITY</div>
                <div class="bar"><div id="hp-fill" class="bar-fill" style="background: var(--hk-pink); width: 100%;"></div></div>
            </div>
            <div id="level-display">
                <div style="font-size: 18px;">LVL <span id="lvl-txt">1</span></div>
                <div style="font-size: 7px; margin-top: 5px;">GLINTS: <span id="glint-txt">0</span></div>
            </div>
        </div>
        <canvas id="gameCanvas"></canvas>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const container = document.getElementById('game-container');
    
    canvas.width = 1000;
    canvas.height = 600;

    // --- WORLD SETTINGS ---
    const WORLD = { width: 3000, height: 2000 };
    let camera = { x: 0, y: 0 };
    let frame = 0;

    // --- PLAYER ---
    let kitty = {
        x: 1500, y: 1000, w: 32, h: 40,
        vx: 0, vy: 0, speed: 5,
        hp: 100, maxHp: 100,
        lvl: 1, glints: 0,
        trail: []
    };

    // --- ENEMIES & PROJECTILES ---
    let nightmare = { x: 1200, y: 800, r: 40, speed: 2.5, shootTimer: 0 };
    let bullets = [];
    let glints = [];
    let foliage = [];
    let stars = [];

    // Initialize World Details
    for(let i=0; i<400; i++) stars.push({x: Math.random()*WORLD.width, y: Math.random()*WORLD.height, s: Math.random()*2});
    for(let i=0; i<60; i++) foliage.push({x: Math.random()*WORLD.width, y: Math.random()*WORLD.height, r: 10+Math.random()*20, color: Math.random() > 0.5 ? '#220011' : '#110022'});
    for(let i=0; i<15; i++) spawnGlint();

    function spawnGlint() {
        glints.push({ x: Math.random()*WORLD.width, y: Math.random()*WORLD.height, s: 8 + Math.random()*5 });
    }

    const keys = {};
    window.onkeydown = (e) => keys[e.code] = true;
    window.onkeyup = (e) => keys[e.code] = false;

    function update() {
        frame++;
        
        // Kitty Movement
        if (keys['ArrowLeft'] || keys['KeyA']) kitty.vx = -kitty.speed;
        else if (keys['ArrowRight'] || keys['KeyD']) kitty.vx = kitty.speed;
        else kitty.vx *= 0.8;

        if (keys['ArrowUp'] || keys['KeyW']) kitty.vy = -kitty.speed;
        else if (keys['ArrowDown'] || keys['KeyS']) kitty.vy = kitty.speed;
        else kitty.vy *= 0.8;

        kitty.x += kitty.vx;
        kitty.y += kitty.vy;

        // Keep in bounds
        kitty.x = Math.max(0, Math.min(WORLD.width - kitty.w, kitty.x));
        kitty.y = Math.max(0, Math.min(WORLD.height - kitty.h, kitty.y));

        // Trail effect
        if(frame % 2 === 0) {
            kitty.trail.push({x: kitty.x, y: kitty.y, life: 10});
            if(kitty.trail.length > 10) kitty.trail.shift();
        }

        // Camera Follow
        camera.x = kitty.x - canvas.width/2;
        camera.y = kitty.y - canvas.height/2;
        camera.x = Math.max(0, Math.min(camera.x, WORLD.width - canvas.width));
        camera.y = Math.max(0, Math.min(camera.y, WORLD.height - canvas.height));

        // Nightmare AI & Shooting
        let angle = Math.atan2(kitty.y - nightmare.y, kitty.x - nightmare.x);
        nightmare.x += Math.cos(angle) * nightmare.speed;
        nightmare.y += Math.sin(angle) * nightmare.speed;
        
        nightmare.shootTimer++;
        if(nightmare.shootTimer > 60) {
            bullets.push({x: nightmare.x, y: nightmare.y, vx: Math.cos(angle)*7, vy: Math.sin(angle)*7, life: 200});
            nightmare.shootTimer = 0;
        }

        // Bullet Logic
        bullets.forEach((b, i) => {
            b.x += b.vx; b.y += b.vy; b.life--;
            if(Math.hypot(b.x - kitty.x, b.y - kitty.y) < 20) {
                kitty.hp -= 10;
                bullets.splice(i, 1);
                container.style.filter = "invert(1)";
                setTimeout(()=>container.style.filter="none", 50);
            }
        });
        bullets = bullets.filter(b => b.life > 0);

        // Glint Collection
        glints.forEach((g, i) => {
            if(Math.hypot(g.x - kitty.x, g.y - kitty.y) < 40) {
                glints.splice(i, 1);
                kitty.glints++;
                if(kitty.glints % 5 === 0) {
                    kitty.lvl++;
                    kitty.speed += 0.5;
                }
                spawnGlint();
                updateUI();
            }
        });

        if(kitty.hp <= 0) location.reload();
    }

    function updateUI() {
        document.getElementById('hp-fill').style.width = kitty.hp + "%";
        document.getElementById('lvl-txt').innerText = kitty.lvl;
        document.getElementById('glint-txt').innerText = kitty.glints;
    }

    function draw() {
        ctx.fillStyle = "#050005";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.save();
        ctx.translate(-camera.x, -camera.y);

        // 1. Parallax Stars
        ctx.fillStyle = "#444";
        stars.forEach(s => {
            ctx.fillRect(s.x + (camera.x * 0.2), s.y + (camera.y * 0.2), s.s, s.s);
        });

        // 2. Foliage
        foliage.forEach(f => {
            ctx.fillStyle = f.color;
            let wave = Math.sin(frame/20 + f.x) * 5;
            ctx.beginPath();
            ctx.arc(f.x, f.y + wave, f.r, 0, Math.PI*2);
            ctx.fill();
        });

        // 3. Glints (Hearts)
        glints.forEach(g => {
            ctx.shadowBlur = 15; ctx.shadowColor = "#ff007f";
            ctx.fillStyle = "#ff007f";
            let pulse = Math.sin(frame/10) * 3;
            ctx.fillRect(g.x - (g.s+pulse)/2, g.y - (g.s+pulse)/2, g.s+pulse, g.s+pulse);
            ctx.shadowBlur = 0;
        });

        // 4. Kitty & Trail
        kitty.trail.forEach((t, i) => {
            ctx.globalAlpha = i/20;
            ctx.fillStyle = "#ff99cc";
            ctx.fillRect(t.x, t.y, kitty.w, kitty.h);
        });
        ctx.globalAlpha = 1.0;

        // Kitty Core
        ctx.fillStyle = "white"; 
        ctx.fillRect(kitty.x, kitty.y, kitty.w, 20); // Head
        ctx.fillStyle = "black";
        ctx.fillRect(kitty.x, kitty.y + 20, kitty.w, 20); // Dress
        // Red Bow
        ctx.fillStyle = "#ee0000";
        ctx.fillRect(kitty.x + 20, kitty.y - 5, 15, 10);

        // 5. Nightmare Paws
        ctx.shadowBlur = 30; ctx.shadowColor = "red";
        ctx.fillStyle = "#110005";
        ctx.beginPath();
        ctx.arc(nightmare.x, nightmare.y, nightmare.r + Math.sin(frame/5)*5, 0, Math.PI*2);
        ctx.fill();
        // Eyes
        ctx.fillStyle = "#ff007f";
        ctx.fillRect(nightmare.x - 15, nightmare.y - 10, 8, 8);
        ctx.fillRect(nightmare.x + 7, nightmare.y - 10, 8, 8);

        // 6. Bullets
        ctx.fillStyle = "#ff007f";
        bullets.forEach(b => {
            ctx.beginPath();
            ctx.arc(b.x, b.y, 5, 0, Math.PI*2);
            ctx.fill();
        });

        ctx.restore();
    }

    function loop() {
        update();
        draw();
        requestAnimationFrame(loop);
    }

    updateUI();
    loop();
</script>
</body>
</html>
